<!DOCTYPE html>
<html lang="en">
  <head>
    {% include 'header.html' %}
    <title>New Project - mian</title>
  </head>

  <body>

    <div class="alert alert-warning">
        <strong>Thanks for stopping by!</strong> Mian is still undergoing alpha testing so you may run into some bugs. You can help make Mian better by filing issues in <a href="https://github.com/tbj128/mian/issues" target="_blank">our Github repo</a> or by <a href="mailto:tom.jin@outlook.com" target="_blank">emailing us here</a>.
    </div>
    {% include 'navigation.html' %}
    {% include 'loading-bar-processing.html' %}

    <div id="welcome" class="container">
      <div class="section-heading project-heading">
          <h2><i class="fa fa-plus-circle"></i>&nbsp;&nbsp;New Project</h2>
      </div>

      <div id="welcome-container" class="row welcome-container">
        <input type="text" class="form-control upload-name" id="inputName" name="inputName" placeholder="Project Name" required>
        <div class="help-block with-errors"></div>

        <div id="otu-upload-container">
          <div id="otu-table-upload-container" class="row upload-item">
            <div>
              <div class="col-md-10">
                <h3 style="margin-top:0px"><i class="fa fa-table"></i>&nbsp;&nbsp;OTU Table</h3>
                <p>Tab-delimited file with OTUs across the top header and sample/group IDs as rows. Accepted formats shown below.</p>
                  <p>Example manually created OTU format: </p>
<pre><code>Sample	Otu01	Otu02	Otu03	Otu04	Otu05	...
1a	0	5	2	3	3	...
1b	7	2	5	1	1	...
</code></pre>
              </div>
              <div class="col-md-2 upload-status">
                <form id="otuTableForm" action="/upload" method="post" enctype="multipart/form-data">
                  <input type="hidden" name="category" value="otuTable" />
                  <span id="otuTableOK" style="display:none;font-size:24px;margin:0 20px 0 0;vertical-align: middle;"><i class="glyphicon glyphicon-ok"></i></span>
                  <span id="otuTableLoading" style="display:none;">
                    <i class="fa fa-spinner upload-loading"></i>
                  </span>
                  <span id="otuTableWrapper" class="btn btn-default btn-file">
                      <span id="otuTableText">Upload</span> <input type="file" name="upload" id="otuTable" accept=".tsv,.txt,.shared" />
                  </span>
                </form>
              </div>
              <div style="clear:both"></div>
            </div>
            <div style="margin-top:8px;padding-top:8px;border-top:1px dashed #999;">
              <div>
                <h4 style="padding-left: 15px;">Additional Subsampling</h4>
                <p style="padding-left: 15px;">Subsampling is necessary for some visualizations and statistical tests. The subsampling can be adjusted at any time.</p>
                <div class="col-md-6">
                  <select id="subsampleType" name="subsampleType" class="form-control pad-bottom">
                    <option value="no" selected>Don't Subsample</option>
                    <option value="auto" >Auto Subsample</option>
                    <option value="manual">Manual Subsample</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <input type="number" class="form-control" id="subsampleTo" name="subsampleTo" placeholder="Subsample To..." style="display:none;">
                  <p id="auto-prompt" style="font-size:11px;color:#999;">Subsamples each sample in the OTU table to the smallest number of sequences of any sample.</p>
                  <p id="manual-prompt" style="font-size:11px;color:#999;margin-top:6px;display:none;">Subsamples each sample in the OTU table to a specific value.</p>
                  <p id="no-prompt" style="font-size:11px;color:#999;display:none;">Assumes that the uploaded OTU table is subsampled already. (Does not perform subsampling)</p>
                </div>
              </div>
            </div>
          </div>

          <div id="sample-metadata-upload-container" class="row upload-item" >
            <div class="col-md-10">
              <h3 style="margin-top:0px"><i class="fa fa-info"></i>&nbsp;&nbsp;Sample Metadata</h3>
              <p>Tab-delimited file with each row representing an sample/group ID and its corresponding metadata. Example metadata:</p>
<pre><code>Sample	body_site	disease	...
1a	gut		Disease	...
1b	skin		Control	...
</code></pre>
            </div>
            <div class="col-md-2 upload-status">
              <form id="otuMetadataForm" action="/upload" method="post" enctype="multipart/form-data">
                <input type="hidden" name="category" value="otuMetadata" />
                <span id="otuMetadataOK" style="display:none;font-size:24px;margin:0 20px 0 0;vertical-align: middle;"><i class="glyphicon glyphicon-ok"></i></span>
                <span id="otuMetadataLoading" style="display:none;">
                  <i class="fa fa-spinner upload-loading"></i>
                </span>
                <span id="otuMetadataWrapper" class="btn btn-default btn-file">
                    <span id="otuMetadataText">Upload</span> <input type="file" name="upload" id="otuMetadata" accept=".txt,.tsv" />
                </span>
              </form>
            </div>
          </div>
        </div>
        <div class="row upload-item" style="background:none !important;box-shadow:none !important;text-align:center;padding-top:0px;padding-right:0px;">
          <form data-toggle="validator" method="POST" action="/create">
            <input type="hidden" id="projectName" name="projectName" value="" />
            <input type="hidden" id="projectUploadType" name="projectUploadType" value="otu" />
            <input type="hidden" id="projectOTUTableName" name="projectOTUTableName" value="" />
            <input type="hidden" id="projectSampleIDName" name="projectSampleIDName" value="" />
            <input type="hidden" id="projectSubsampleType" name="projectSubsampleType" value="auto" />
            <input type="hidden" id="projectSubsampleTo" name="projectSubsampleTo" value="" />
            <button id="upload-submit" type="submit" class="btn btn-primary" style="width:180px;" disabled>Create</button>
          </form>
        </div>
      </div>
    </div><!-- /.container -->

    {% include 'footer-full.html' %}

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/core.upload.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!--<script src="static/js/ie10-viewport-bug-workaround.js"></script>-->

  </body>
</html>
